---
title: "Home_ask_4"
format: html
editor: visual
---
```{r}

```
Задание 1.
Нулевая гипотеза (H0):
Новый препарат не влияет на снижение артериального давления, или его эффективность не отличается от стандартной терапии. Альтернативная гипотеза (H1):
Новый препарат эффективнее снижает артериальное давление по сравнению со стандартной терапией. 
2. Уровень значимости (α)
Уровень значимости (α) обычно выбирается заранее и означает вероятность отклонения нулевой гипотезы, когда она на самом деле верна. Стандартные значения: 0.05 или 0.01. Допустим, выберем α = 0.05.
3. Выбор статистического теста
Для проверки этой гипотезы подходит t-тест для зависимых выборок, так как мы сравниваем показатели давления одной и той же группы пациентов до и после приема нового препарата.
Выводы по задаче - p-value - значительно меньше 0.05, следовательно есть основания опровергнуть нулевую гипотезу и принять альтернативную.
```{r}
set.seed(123)  # Устанавливаем seed для воспроизводимости
sample_size <- 30  # Размер выборки

# Генерируем данные
pressure_before <- rnorm(sample_size, 140, 10)  # Давление до
pressure_after <- pressure_before - rnorm(sample_size, 5, 5)  # Давление после

# Выполняем парный t-тест
t_test_result <- t.test(pressure_before, pressure_after, paired = TRUE)
print(t_test_result)


```

Задание 2.

Формулировка гипотез
Нулевая гипотеза (H0):
Существует незначительная или нулевая связь между курением и развитием рака легких, т.е., разница между пропорциями заболеваемости курящих и некурящих не статистически значима.

Альтернативная гипотеза (H1):
Существует статистически значимая связь между курением и развитием рака легких, т.е., пропорция заболеваемости среди курящих значимо выше, чем среди некурящих.

Уровень значимости установим на 0.05.
Выбор статистического теста
Для сравнения двух пропорций (вероятности развития рака легких у курящих и некурящих) используем z-тест для двух пропорций. Этот выбор обусловлен тем, что мы сравниваем доли в двух независимых выборках.

Выводы по задаче - После выполнения z-теста для двух пропорций, мы оцениваем p-value, полученное для каждой из выборок. p-value меньше установленного уровня значим, отклоняем нулевую гипотезу, что указывает на статистически значимую связь между курением и развитием рака легких. Это означает, что различие в долях заболевших раком легких между курящими и некурящими является статистически значимым.

```{r}
set.seed(42)  # Для воспроизводимости результатов

generate_data <- function(sample_size, prob_smokers, prob_nonsmokers) {
  smokers <- rbinom(sample_size / 2, 1, prob_smokers)
  nonsmokers <- rbinom(sample_size / 2, 1, prob_nonsmokers)
  data <- c(smokers, nonsmokers)
  return(data)
}

# Параметры вероятностей
prob_smokers <- 0.8
prob_nonsmokers <- 0.2

# Генерация данных для двух выборок
data_100 <- generate_data(100, prob_smokers, prob_nonsmokers)
data_30 <- generate_data(30, prob_smokers, prob_nonsmokers)

```

```{r}
perform_test <- function(data, sample_size) {
  smoker_count <- sum(data[1:(sample_size / 2)])
  nonsmoker_count <- sum(data[(sample_size / 2 + 1):sample_size])
  
  # Количество успехов в каждой группе
  successes <- c(smoker_count, nonsmoker_count)
  # Объем каждой группы
  n <- c(sample_size / 2, sample_size / 2)
  
  test_result <- prop.test(successes, n)
  return(test_result)
}

# Выполнение теста для каждой выборки
test_result_100 <- perform_test(data_100, 100)
test_result_30 <- perform_test(data_30, 30)

# Вывод результатов
print(test_result_100)
print(test_result_30)

```
Задание 3.

Нулевая гипотеза (H0):
Применение нового метода лечения не меняет уровень болевых симптомов по сравнению с диетотерапией, то есть различия в средних уровнях болевых симптомов между группами не статистически значимы.Альтернативная гипотеза (H1):
Применение нового метода лечения значимо меняет уровень болевых симптомов по сравнению с диетотерапией, то есть существует статистически значимое различие в средних уровнях болевых симптомов между группами.
Определим уровень значимости как α=0.05, что является стандартным выбором для многих исследований.
Так как исследователь избегает любых допущений о распределении данных, кроме того, что выборки независимы и имеют одинаковое распределение, наиболее подходящим тестом будет непараметрический тест Уилкоксона-Манна-Уитни (или просто тест Манна-Уитни) для двух независимых выборок. Этот тест не требует предположений о нормальности распределения данных.

Выводы по задаче - p-value выше альфа, следовательно нет оснований опровергнуть нулевую гипотезу - Применение нового метода лечения не меняет уровень болевых симптомов по сравнению с диетотерапией.
```{r}
set.seed(42)  # Для воспроизводимости

# Генерация данных
size <- 30  # Размер каждой из выборок
symptoms_new_treatment <- runif(size, min=1, max=10)  # Уровень симптомов после нового лечения
symptoms_diet <- runif(size, min=1, max=10)  # Уровень симптомов после диетотерапии

# Выбор статистического теста и выполнение
test_result <- wilcox.test(symptoms_new_treatment, symptoms_diet)

# Вывод результатов
print(test_result)

```

Задание 4.Дисперсионный анализ (ANOVA)
Гипотеза: Размеры опухоли одинаковы для всех трех групп терапии.
Результаты: F value = 5.555, Pr(>F) = 0.00954.
Интерпретация: ANOVA показывает, что p-value меньше 0.05, что указывает на наличие статистически значимых различий в размерах опухолей между как минимум двумя из трех групп. Таким образом, мы отклоняем нулевую гипотезу о том, что все терапии одинаково эффективны.

Попарные сравнения с использованием критерия Тьюки
Гипотеза: Нет значимой разницы в эффективности между отдельными терапиями.
Результаты и интерпретация:

A vs. 0 (плацебо):

Разница: -1066.1727
p-value: 0.0470127
Интерпретация: Существует статистически значимая разница между терапией A и плацебо, что указывает на большую эффективность терапии A в уменьшении размера опухоли.
B vs. 0 (плацебо):

Разница: -1341.2860
p-value: 0.0105799
Интерпретация: Существует статистически значимая разница между терапией B и плацебо, что указывает на большую эффективность терапии B в сравнении с плацебо.
B vs. A:

Разница: -275.1133
p-value: 0.7955378
Интерпретация: Нет статистически значимой разницы между терапией B и терапией A, что указывает на то, что обе терапии имеют схожую эффективность в контексте исследования.
Общий вывод
Исследование показывает, что обе терапии (A и B) эффективнее плацебо в уменьшении размера опухоли у мышей. Однако между самими терапиями A и B значимой разницы обнаружено не было, что говорит об их схожей эффективности. Это может быть полезно для дальнейшего изучения этих препаратов и определения наиболее оптимального курса лечения.

```{r}
library(tidyverse)

# Создание датасета
tumor <- tibble(
  therapy = c(rep("0", 10), rep("A", 10), rep("B", 10)),
  value = c(rep(3213, 10), rep(2687, 10), rep(2423, 10))
) %>%
  mutate(therapy = factor(therapy, levels = c("0", "A", "B")))

# Добавление нормально распределенного шума к значениям размеров опухолей
set.seed(42)
tumor$value <- tumor$value + rnorm(30, 0, 760)

# Построение ящиков с усами
ggplot(tumor, aes(x=therapy, y=value, fill=therapy)) +
  geom_boxplot() +
  theme_minimal() +
  labs(title="Размер опухоли по группам терапии", x="Группа терапии", y="Размер опухоли")

```
```{r}
# Проведение дисперсионного анализа
anova_result <- aov(value ~ therapy, data=tumor)
summary(anova_result)
# Попарные сравнения с использованием критерия Тьюки
tukey_result <- TukeyHSD(anova_result)
tukey_result

```





